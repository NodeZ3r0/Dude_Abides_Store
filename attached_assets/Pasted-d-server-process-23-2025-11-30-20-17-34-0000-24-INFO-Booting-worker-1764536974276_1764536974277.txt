d server process [23]                         [2025-11-30 20:17:34 +0000] [24] [INFO] Booting worker with pid: 24                         [2025-11-30 20:17:34 +0000] [25] [INFO] Booting worker with pid: 25                         [2025-11-30 20:17:34 +0000] [25] [INFO] Started server process [25]                         [2025-11-30 20:17:34 +0000] [24] [INFO] Started server process [24]                         [2025-11-30 20:17:34 +0000] [26] [INFO] Booting worker with pid: 26                         [2025-11-30 20:17:35 +0000] [26] [INFO] Started server process [26]                         root@WOPR:/opt/Dude_Abides_Store#             root@WOPR:/opt/Dude_Abides_Store# cd /opt/thedudeabides-store/storefront                    root@WOPR:/opt/thedudeabides-store/storefront# docker compose up -d                         WARN[0000] /opt/thedudeabides-store/storefront/docker-compose.yml: `version` is obsolete    [+] Running 1/0                                ✔ Container saleor-storefront  Running  0.0s root@WOPR:/opt/thedudeabides-store/storefront# docker ps | grep storefront                  9ebf24257158   storefront-saleor-storefront              "docker-entrypoint.s…"   47 minutes ago   Up 47 minutes          0.0.0.0:3001->3000/tcp                           saleor-storefront                                          root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # View current config                        root@WOPR:/opt/thedudeabides-store/storefront# cat /etc/caddy/sites-enabled/dudeabides.wopr.systems.caddy                                 dudeabides.wopr.systems {                                                                       # -------------------------                   # SALEOR API + DASHBOARD                      # -------------------------                   handle_path /graphql* {                           reverse_proxy http://127.0.0.1:8000       }                                                                                           handle_path /dashboard* {                         reverse_proxy http://127.0.0.1:8000       }                                                                                           # -------------------------                   # VITE STOREFRONT ON 3004                     # -------------------------                   handle {                                          reverse_proxy 127.0.0.1:3004              }                                         }                                             root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # Edit it - /graphql should go to port 8000 (API), not 3001 (storefront)                   root@WOPR:/opt/thedudeabides-store/storefront# sudo nano /etc/caddy/sites-enabled/dudeabides.wopr.systems.caddy                           root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # See all containers and their ports         root@WOPR:/opt/thedudeabides-store/storefront# docker ps -a --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"                          NAMES                           STATUS                   PORTS                              saleor-api-dude                 Up 45 minutes            0.0.0.0:8000->8000/tcp             saleor-storefront               Up 55 minutes            0.0.0.0:3001->3000/tcp             printful-sync-printful-sync-1   Up 7 hours               0.0.0.0:8055->8055/tcp             saleor-dashboard-dude           Exited (0) 7 hours ago                                      saleor-postgres-dude            Up 7 hours               5432/tcp                           saleor-redis-dude               Up 7 hours               6379/tcp                           saleor-worker-dude              Up 7 hours               8000/tcp                           group7-peertube                 Up 7 hours               1935-1936/tcp, 0.0.0.0:9003->9000/tcp                                            peertube-postgres               Up 7 hours               5432/tcp                           peertube-redis                  Up 7 hours               6379/tcp                           authentik_server                Up 7 hours (healthy)     0.0.0.0:9000->9000/tcp, 0.0.0.0:9443->9443/tcp                                   authentik_worker                Up 7 hours (healthy)                                        authentik_redis                 Up 7 hours               6379/tcp                           authentik-postgresql-1          Up 7 hours               5432/tcp                           gotosocial                      Up 7 hours               0.0.0.0:8080->8080/tcp             root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # See what's listening on those ports        root@WOPR:/opt/thedudeabides-store/storefront# ss -tlnp | grep -E '3001|3004|8000|9002'     LISTEN 0      4096         0.0.0.0:3001       0.0.0.0:*    users:(("dockerd",pid=2463541,fd=109))                                                                                                                                     LISTEN 0      4096         0.0.0.0:8000       0.0.0.0:*    users:(("dockerd",pid=2463541,fd=137))                                                                                                                                     root@WOPR:/opt/thedudeabides-store/storefront# # 1. Update Caddy config                     root@WOPR:/opt/thedudeabides-store/storefront# sudo tee /etc/caddy/sites-enabled/dudeabides.wopr.systems.caddy > /dev/null << 'EOF'       > dudeabides.wopr.systems {                   >     # SALEOR API (use 'handle' not 'handle_path' to preserve the path)                    >     handle /graphql* {                      >         reverse_proxy http://127.0.0.1:8000 >     }                                       >                                             >     # STOREFRONT (port 3001, not 3004)      >     handle {                                >         reverse_proxy 127.0.0.1:3001        >     }                                       > }                                           > EOF                                         root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # 2. Reload Caddy                            root@WOPR:/opt/thedudeabides-store/storefront# sudo systemctl reload caddy                                                                # 3. Test API directly first                  curl -s -X POST http://127.0.0.1:8000/graphql/ \                                              -H 'Content-Type: application/json' \         -d '{"query": "{ __typename }"}'                                                          # 4. Test through Caddy                       curl -s -X POST https://dudeabides.wopr.systems/graphql/ \                                    -H 'Content-Type: application/json' \         -d '{"query": "{ __typename }"}'                                                          # 5. Test storefront                          curl -I https://dudeabides.wopr.systems/root@WOPR:/opt/thedudeabides-store/storefront#      root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# curl -I https://dudeabides.wopr.systems/     HTTP/2 307                                    date: Sun, 30 Nov 2025 21:05:53 GMT           content-type: text/html; charset=utf-8        cache-control: s-maxage=31536000              report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=n96fRmqO1YAD%2F3bfAPL0LDZkvUPaNA0nVO9XAo4QgBp7z01tbrbVt4Jew6AL8uk322AsTohtds0S9BGlv%2FWp4eFpQpDnKe9Liw7YSPPQKC81609RdYp%2F"}]}                                          location: /default-channel                    vary: RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch, Accept-Encoding                                    via: 1.1 Caddy                                x-nextjs-cache: HIT                           x-nextjs-prerender: 1                         x-nextjs-stale-time: 4294967294               x-powered-by: Next.js                         nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}                         cf-cache-status: DYNAMIC                      server: cloudflare                            cf-ray: 9a6d4e36c83e5894-HEL                                                                root@WOPR:/opt/thedudeabides-store/storefront# # Test API directly                          root@WOPR:/opt/thedudeabides-store/storefront# curl -s -X POST http://127.0.0.1:8000/graphql/ \                                           >   -H 'Content-Type: application/json' \     >   -d '{"query": "{ __typename }"}'          {"data": {"__typename": "Query"}, "extensions": {"cost": {"requestedQueryCost": 0, "maximumAvailable": 50000}}}root@WOPR:/opt/thedudeabides-store/storefront#                           root@WOPR:/opt/thedudeabides-store/storefront# # Test through Caddy                         root@WOPR:/opt/thedudeabides-store/storefront# curl -s -X POST https://dudeabides.wopr.systems/graphql/ \                                 >   -H 'Content-Type: application/json' \     >   -d '{"query": "{ __typename }"}'          {"data": {"__typename": "Query"}, "extensions": {"cost": {"requestedQueryCost": 0, "maximumAvailable": 50000}}}root@WOPR:/opt/thedudeabides-store/storefront#                           root@WOPR:/opt/thedudeabides-store/storefront# # 1. Check product status                    root@WOPR:/opt/thedudeabides-store/storefront# curl -s -X POST https://dudeabides.wopr.systems/graphql/ \                                 >   -H 'Content-Type: application/json' \     >   -H "Authorization: Bearer lethwrqrb5ur5MPtLwzemb68OgSPGX" \                             >   -d '{"query": "query { product(id: \"UHJvZHVjdDox\") { id name channelListings { channel { slug } isPublished } variants { id name sku } } }"}' | python3 -m json.tool              Expecting value: line 1 column 1 (char 0)     root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # 2. Publish to the-dude-abides-shop channel with availability date                        root@WOPR:/opt/thedudeabides-store/storefront# curl -s -X POST https://dudeabides.wopr.systems/graphql/ \                                 >   -H 'Content-Type: application/json' \     >   -H "Authorization: Bearer lethwrqrb5ur5MPtLwzemb68OgSPGX" \                             >   -d '{                                     >     "query": "mutation { productChannelListingUpdate(id: \"UHJvZHVjdDox\", input: { updateChannels: [{ channelId: \"Q2hhbm5lbDoy\", isPublished: true, visibleInListings: true, isAvailableForPurchase: true, availableForPurchaseAt: \"2024-01-01\" }] }) { product { channelListings { channel { slug } isPublished isAvailableForPurchase } } errors { field message } } }">   }' | python3 -m json.tool                 Expecting value: line 1 column 1 (char 0)     root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # 3. Verify product appears in the channel   root@WOPR:/opt/thedudeabides-store/storefront# curl -s -X POST https://dudeabides.wopr.systems/graphql/ \                                 >   -H 'Content-Type: application/json' \     >   -d '{"query": "query { products(first: 5, channel: \"the-dude-abides-shop\") { edges { node { id name } } } }"}' | python3 -m json.tool                                             {                                                 "data": {                                         "products": {                                     "edges": []                               }                                         },                                            "extensions": {                                   "cost": {                                         "requestedQueryCost": 5,                      "maximumAvailable": 50000                 }                                         }                                         }                                             root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # Test with auth directly on port 8000       root@WOPR:/opt/thedudeabides-store/storefront# curl -s -X POST http://127.0.0.1:8000/graphql/ \                                           >   -H 'Content-Type: application/json' \     >   -H "Authorization: Bearer lethwrqrb5ur5MPtLwzemb68OgSPGX" \                             >   -d '{"query": "query { product(id: \"UHJvZHVjdDox\") { id name channelListings { channel { slug } isPublished } } }"}' | python3 -m json.tool                                       Expecting value: line 1 column 1 (char 0)     root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # Publish product directly                   root@WOPR:/opt/thedudeabides-store/storefront# curl -s -X POST http://127.0.0.1:8000/graphql/ \                                           >   -H 'Content-Type: application/json' \     >   -H "Authorization: Bearer lethwrqrb5ur5MPtLwzemb68OgSPGX" \                             >   -d '{"query": "mutation { productChannelListingUpdate(id: \"UHJvZHVjdDox\", input: { updateChannels: [{ channelId: \"Q2hhbm5lbDoy\", isPublished: true, visibleInListings: true, isAvailableForPurchase: true, availableForPurchaseAt: \"2024-01-01\" }] }) { product { channelListings { channel { slug } isPublished } } errors { field message } } }"}' | python3 -m json.tool                                                                                       Expecting value: line 1 column 1 (char 0)     root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront# # Verify                                     root@WOPR:/opt/thedudeabides-store/storefront# curl -s -X POST http://127.0.0.1:8000/graphql/ \                                           >   -H 'Content-Type: application/json' \     >   -d '{"query": "query { products(first: 5, channel: \"the-dude-abides-shop\") { edges { node { id name } } } }"}' | python3 -m json.tool                                             {                                                 "data": {                                         "products": {                                     "edges": []                               }                                         },                                            "extensions": {                                   "cost": {                                         "requestedQueryCost": 5,                      "maximumAvailable": 50000                 }                                         }                                         }                                             root@WOPR:/opt/thedudeabides-store/storefront#                                              root@WOPR:/opt/thedudeabides-store/storefront#