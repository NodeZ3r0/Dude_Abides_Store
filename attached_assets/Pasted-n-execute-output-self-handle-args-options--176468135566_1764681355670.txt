n execute                                         output = self.handle(*args, **options)                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^      File "/usr/local/lib/python3.12/site-packages/django/core/management/commands/shell.py", line 117, in handle                                exec(options["command"], globals())         File "<string>", line 2, in <module>        ImportError: cannot import name 'Attribute' from 'saleor.product.models' (/app/saleor/product/models.py)                                  root@WOPR:/opt/printful-sync# # 1. Fix product type and attributes                          root@WOPR:/opt/printful-sync# docker exec -it saleor-api-dude python manage.py shell -c "   tion($i:ProductCreateInput!){productCreate(input:$i){product{id}errors{field message}}}", {"i": {"name": prod["name"], "slug": slug, "productType": "UHJvZHVjdFR5cGU6MQ==", "category": "Q2F0ZWdvcnk6MQ=="}})                             if res["productCreate"].get("errors"):            res = saleor_gql("mutation($i:ProductCreateInput!){productCreate(input:$i){product{id}errors{message}}}", {"i": {"name": prod["name"], "slug": f"{slug}-new", "productType": "UHJvZHVjdFR5cGU6MQ==", "category": "Q2F0ZWdvcnk6MQ=="}})                                          pid = res["productCreate"]["product"]["id"]                                                                                               saleor_gql("mutation($id:ID!,$i:ProductChannelListingUpdateInput!){productChannelListingUpdate(id:$id,input:$i){errors{message}}}", {"id": pid, "i": {"updateChannels": [{"channelId": CHANNEL_ID, "isPublished": True, "visibleInListings": True, "isAvailableForPurchase": True}]}})                                                                                          size_attr, color_attr = get_or_create_attr("size", "Size"), get_or_create_attr("color", "Color")                                                                                        var_inputs = []                               for v in variants:                                sz = get_or_create_val(size_attr, v.get("size") or "One Size")                              cl = get_or_create_val(color_attr, v.get("color") or "Default")                             var_inputs.append({"sku": v["sku"], "name": v[> from saleor.product.models import ProductType, Attribute, AttributeVariant, Product                                             >                                             s> pt = ProductType.objects.first()           > pt.has_variants = True                      > pt.save()                                   >                                             > size = Attribute.objects.filter(slug='size').first()                                      > color = Attribute.objects.filter(slug='color').first()                                    (> if size: AttributeVariant.objects.get_or_create(product_type=pt, attribute=size)         > if color: AttributeVariant.objects.get_or_create(product_type=pt, attribute=color)        >                                             _> # Delete old broken products               > Product.objects.all().delete()              > print('Fixed product type, deleted old products')                                         > "                                                                                         # 2. Update sync service with correct warehouse ID                                          cat > /opt/printful-sync/app.py << 'PYEOF'    import os, requests, logging                  from fastapi import FastAPI, Request          logging.basicConfig(level=logging.INFO)       logger = logging.getLogger("app")             app = FastAPI()                                                                             SALEOR_API_URL = os.getenv("SALEOR_API_URL", "https://dudeabides.wopr.systems/graphql/")    SALEOR_TOKEN = os.getenv("SALEOR_TOKEN")      PRINTFUL_API_KEY = os.getenv("PRINTFUL_API_KEY")                                            PRINTFUL_STORE_ID = os.getenv("PRINTFUL_STORE_ID")                                          CHANNEL_ID = "Q2hhbm5lbDoy"                   WAREHOUSE_ID = "V2FyZWhvdXNlOjk1MzY4Mjk0LTM0ZjktNDQxOC1iZjlhLWEzZWQwZTg4MTNjNw=="                                                         def saleor_gql(query, variables=None):            r = requests.post(SALEOR_API_URL, json={"query": query, "variables": variables or {}}, headers={"Authorization": f"Bearer {SALEOR_TOKEN}", "Content-Type": "application/json"}, timeout=20)                                           logger.info("SALEOR %s: %s", r.status_code, r.text[:1500])                                  j = r.json()                                  if j.get("errors"): raise Exception(j["errors"])                                            return j.get("data")                                                                    def get_or_create_attr(slug, name):               data = saleor_gql("query { attributes(first:100) { edges { node { id slug } } } }")         for e in data["attributes"]["edges"]:             if e["node"]["slug"] == slug: return e["node"]["id"]                                    r = saleor_gql("mutation($i:AttributeCreateInput!){attributeCreate(input:$i){attribute{id}errors{message}}}", {"i": {"slug": slug, "name": name, "type": "PRODUCT_TYPE", "inputType": "DROPDOWN"}})                                   return r["attributeCreate"]["attribute"]["id"]
                                              def get_or_create_val(attr_id, name):
    data = saleor_gql("query($id:ID!){attribute(id:$id){choices(first:100){edges{node{id name}}}}}", {"id": attr_id})                         for e in data["attribute"]["choices"]["edges"]:                                                 if e["node"]["name"].lower() == name.lower(): return e["node"]["id"]                    r = saleor_gql("mutation($a:ID!,$n:String!){attributeValueCreate(attribute:$a,input:{name:$n}){attributeValue{id}errors{message}}}", {"a": attr_id, "n": name})                         return r["attributeValueCreate"]["attributeValue"]["id"]                                                                              def import_product(tid):                          logger.info(f"Importing {tid}")               r = requests.get(f"https://api.printful.com/store/products/{tid}?store_id={PRINTFUL_STORE_ID}", headers={"Authorization": f"Bearer {PRINTFUL_API_KEY}"}, timeout=15)                    r.raise_for_status()                          data = r.json()["result"]                     prod, variants = data["sync_product"], data["sync_variants"]                                slug = f"printful-{tid}"                                                                    res = saleor_gql("mutation($i:ProductCreateInput!){productCreate(input:$i){product{id}errors{field message}}}", {"i": {"name": prod["name"], "slug": slug, "productType": "UHJvZHVjdFR5cGU6MQ==", "category": "Q2F0ZWdvcnk6MQ=="}})                                                 if res["productCreate"].get("errors"):            res = saleor_gql("mutation($i:ProductCreateInput!){productCreate(input:$i){product{id}errors{message}}}", {"i": {"name": prod["name"], "slug": f"{slug}-new", "productType": "UHJvZHVjdFR5cGU6MQ==", "category": "Q2F0ZWdvcnk6MQ=="}})                                          pid = res["productCreate"]["product"]["id"]                                                                                               saleor_gql("mutation($id:ID!,$i:ProductChannelListingUpdateInput!){productChannelListingUpdate(id:$id,input:$i){errors{message}}}", {"id": pid, "i": {"updateChannels": [{"channelId": CHANNEL_ID, "isPublished": True, "visibleInListings": True, "isAvailableForPurchase": True}]}})                                                                                          size_attr, color_attr = get_or_create_attr("size", "Size"), get_or_create_attr("color", "Color")                                                                                        var_inputs = []                               for v in variants:                                sz = get_or_create_val(size_attr, v.get("size") or "One Size")                              cl = get_or_create_val(color_attr, v.get("color") or "Default")                             var_inputs.append({"sku": v["sku"], "name": v["name"], "attributes": [{"id": size_attr, "values": [sz]}, {"id": color_attr, "values": [cl]}], "channelListings": [{"channelId": CHANNEL_ID, "price": str(v["retail_price"])}], "stocks": [{"warehouse": WAREHOUSE_ID, "quantity": 999}]})                                                                                   r = saleor_gql("mutation($p:ID!,$v:[ProductVariantBulkCreateInput!]!){productVariantBulkCreate(product:$p,variants:$v){count results{errors{field message}}}}", {"p": pid, "v": var_inputs})                                          cnt = r["productVariantBulkCreate"]["count"]                                                                                              if prod.get("thumbnail_url"):                     saleor_2025-12-02 13:13:53,556 WARNING saleor.core.jwt_manager RSA_PRIVATE_KEY is missing. Using temporary key for local development with DEBUG mode. [PID:448:MainThread]      Traceback (most recent call last):              File "/app/manage.py", line 10, in <module>     execute_from_command_line(sys.argv)         File "/usr/local/lib/python3.12/site-packages/django/core/management/__init__.py", line 442, in execute_from_command_line                   utility.execute()                           File "/usr/local/lib/python3.12/site-packages/django/core/management/__init__.py", line 436, in execute                                     self.fetch_command(subcommand).run_from_argv(self.argv)                                   File "/usr/local/lib/python3.12/site-packages/django/core/management/base.py", line 412, in run_from_argv                                   self.execute(*args, **cmd_options)          File "/usr/local/lib/python3.12/site-packages/django/core/management/base.py", line 458, in execute                                         output = self.handle(*args, **options)                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^      File "/usr/local/lib/python3.12/site-packages/django/core/management/commands/shell.py", line 117, in handle                                exec(options["command"], globals())         File "<string>", line 2, in <module>        ImportError: cannot import name 'Attribute' from 'saleor.product.models' (/app/saleor/product/models.py)                                  root@WOPR:/opt/printful-sync# # Fix product type with correct imports                       root@WOPR:/opt/printful-sync# docker exec -it saleor-api-dude python manage.py shell -c "   > from saleor.product.models import ProductType                                             > from saleor.attribute.models import Attribute, AttributeVariant                           >                                             > pt = ProductType.objects.first()            > pt.has_variants = True                      > pt.save()                                   >                                             > size = Attribute.objects.filter(slug='size').first()                                      > color = Attribute.objects.filter(slug='color').first()                                    > if size: AttributeVariant.objects.get_or_create(product_type=pt, attribute=size)          > if color: AttributeVariant.objects.get_or_create(product_type=pt, attribute=color)        > print('Done - variants enabled, attributes assigned')                                     > "                                           [ProductVariantBulkCreateInput!]!){productVariantBulkCreate(product:$p,variants:$v){co      # Delete old broken products                  docker exec -it saleor-api-dude python manage.py shell -c "                                 from saleor.product.models import Product     Product.objects.all().delete()                print('Old products deleted')                 "                                                                                           # Write app.py and restart                    cat > /opt/printful-sync/app.py << 'PYEOF'    import os, requests, logging                  from fastapi import FastAPI, Request          logging.basicConfig(level=logging.INFO)       logger = logging.getLogger("app")             app = FastAPI()                                                                             SALEOR_API_URL = os.getenv("SALEOR_API_URL", "https://dudeabides.wopr.systems/graphql/")    SALEOR_TOKEN = os.getenv("SALEOR_TOKEN")      PRINTFUL_API_KEY = os.getenv("PRINTFUL_API_KEY")                                            PRINTFUL_STORE_ID = os.getenv("PRINTFUL_STORE_ID")                                          CHANNEL_ID = "Q2hhbm5lbDoy"                   WAREHOUSE_ID = "V2FyZWhvdXNlOjk1MzY4Mjk0LTM0ZjktNDQxOC1iZjlhLWEzZWQwZTg4MTNjNw=="                                                         def saleor_gql(query, variables=None):            r = requests.post(SALEOR_API_URL, json={"query": query, "variables": variables or {}}, headers={"Authorization": f"Bearer {SALEOR_TOKEN}", "Content-Type": "application/json"}, timeout=20)                                           logger.info("SALEOR %s: %s", r.status_code, r.text[:1500])                                  j = r.json()                                  if j.get("errors"): raise Exception(j["errors"])                                            return j.get("data")                                                                    def get_or_create_attr(slug, name):               data = saleor_gql("query { attributes(first:100) { edges { node { id slug } } } }")         for e in data["attributes"]["edges"]:             if e["node"]["slug"] == slug: return e["node"]["id"]                                    r = saleor_gql("mutation($i:AttributeCreateInput!){attributeCreate(input:$i){attribute{id}errors{message}}}", {"i": {"slug": slug, "name": name, "type": "PRODUCT_TYPE", "inputType": "DROPDOWN"}})                                   return r["attributeCreate"]["attribute"]["id"]                                                                                        def get_or_create_val(attr_id, name):             data = saleor_gql("query($id:ID!){attribute(id:$id){choices(first:100){edges{node{id name}}}}}", {"id": attr_id})                         for e in data["attribute"]["choices"]["edges"]:                                                 if e["node"]["name"].lower() == name.lower(): return e["node"]["id"]                    r = saleor_gql("mutation($a:ID!,$n:String!){attributeValueCreate(attribute:$a,input:{name:$n}){attributeValue{id}errors{message}}}", {"a": attr_id, "n": name})                         return r["attributeValueCreate"]["attributeValue"]["id"]                                                                              def import_product(tid):                          logger.info(f"Importing {tid}")               r = requests.get(f"https://api.printful.com/store/products/{tid}?store_id={PRINTFUL_STORE_ID}", headers={"Authorization": f"Bearer {PRINTFUL_API_KEY}"}, timeout=15)                    r.raise_for_status()                          data = r.json()["result"]                     prod, variants = data["sync_product"], data["sync_variants"]                                slug = f"printful-{tid}"                                                                    res = saleor_gql("mutation($i:ProductCreateInput!){productCreate(input:$i){product{id}errors{field message}}}", {"i": {"name": prod["name"], "slug": slug, "productType": "UHJvZHVjdFR5cGU6MQ==", "category": "Q2F0ZWdvcnk6MQ=="}})                                                 if res["productCreate"].get("errors"):            res = saleor_gql("mutation($i:ProductCreateInput!){productCreate(input:$i){product{id}errors{message}}}", {"i": {"name": prod["name"], "slug": f"{slug}-new", "productType": "UHJvZHVjdFR5cGU6MQ==", "category": "Q2F0ZWdvcnk6MQ=="}})                                          pid = res["productCreate"]["product"]["id"]                                                                                               saleor_gql("mutation($id:ID!,$i:ProductChannelListingUpdateInput!){productChannelListingUpdate(id:$id,input:$i){errors{message}}}", {"id": pid, "i": {"updateChannels": [{"channelId": CHANNEL_ID, "isPublished": True, "visibleInListings": True, "isAvailableForPurchase": True}]}})                                                                                          size_attr, color_attr = get_or_create_attr("size", "Size"), get_or_create_attr("color", "Color")                                                                                        var_inputs = []                               for v in variants:                                sz = get_or_create_val(size_attr, v.get("size") or "One Size")                              cl = get_or_create_val(color_attr, v.get("color") or "Default")                             var_inputs.append({"sku": v["sku"], "name": v["name"], "attributes": [{"id": size_attr, "values": [sz]}, {"id": color_attr, "values": [cl]}], "channelListings": [{"channelId": CHANNEL_ID, "price": str(v["retail_price"])}], "stocks": [{"warehouse": WAREHOUSE_ID, "quantity": 999}]})                                                                                   r = saleor_gql("mutation($p:ID!,$v:[ProductVariantBulkCreateInput!]!){productVariantBulkCreate(product:$p,variants:$v){co2025-12-02 13:15:21,276 WARNING saleor.core.jwt_manager RSA_PRIVATE_KEY is missing. Using temporary key for local development with DEBUG mode. [PID:478:MainThread]                                  Done - variants enabled, attributes assigned  root@WOPR:/opt/printful-sync#