Tue 2025-12-02 10:36:12 CST 4min 57s Tue 2025-12-02 10:31:12 CST       2s ago dude-deploy.timer              dude-deploy.service          root@WOPR:/opt/printful-sync# # Update deploy script with your email                        root@WOPR:/opt/printful-sync# sed -i 's/your-email@example.com/stephen.falken@wopr.systems/' /opt/thedudeabides-store/deploy.sh           root@WOPR:/opt/printful-sync#                 root@WOPR:/opt/printful-sync# # Create the rate-limited notification script                 root@WOPR:/opt/printful-sync# cat > /opt/thedudeabides-store/notify-failure.sh << 'EOF'     > #!/bin/bash                                 > LAST_EMAIL_FILE="/tmp/dude-deploy-last-email"                                             > EMAIL="stephen.falken@wopr.systems"         > COOLDOWN=86400  # 24 hours in seconds       >                                             > NOW=$(date +%s)                             > LAST=$(cat "$LAST_EMAIL_FILE" 2>/dev/null || echo 0)                                      > DIFF=$((NOW - LAST))                        >                                             > if [ $DIFF -gt $COOLDOWN ]; then            >     echo "Dude Deploy failed at $(date). Check logs with: journalctl -u dude-deploy.service" | mail -s "⚠️ Dude Deploy FAILED" "$EMAIL"  >     echo "$NOW" > "$LAST_EMAIL_FILE"        >     echo "Email sent to $EMAIL"             > else                                        >     echo "Email cooldown active. Last sent $((DIFF/3600)) hours ago."                     > fi                                          > EOF                                         root@WOPR:/opt/printful-sync# chmod +x /opt/thedudeabides-store/notify-failure.sh           root@WOPR:/opt/printful-sync#                 root@WOPR:/opt/printful-sync# # Create notification service                                 root@WOPR:/opt/printful-sync# cat > /etc/systemd/system/dude-deploy-notify.service << 'EOF' > [Unit]                                      > Description=Notify on Dude Deploy Failure   >                                             > [Service]                                   > Type=oneshot                                > ExecStart=/opt/thedudeabides-store/notify-failure.sh                                      > EOF                                         root@WOPR:/opt/printful-sync#                 root@WOPR:/opt/printful-sync# # Update deploy service to trigger notification on failure    root@WOPR:/opt/printful-sync# cat > /etc/systemd/system/dude-deploy.service << 'EOF'
> [Unit]                                      > Description=The Dude Abides Store Deploy    > After=network.target                        > OnFailure=dude-deploy-notify.service        >                                             > [Service]                                   > Type=oneshot                                > ExecStart=/opt/thedudeabides-store/deploy.sh> StandardOutput=journal                      > StandardError=journal                       >                                             > [Install]                                   > WantedBy=multi-user.target                  > EOF                                         root@WOPR:/opt/printful-sync#                 root@WOPR:/opt/printful-sync# # Reload systemdroot@WOPR:/opt/printful-sync# systemctl daemon-reload                                       root@WOPR:/opt/printful-sync#                 root@WOPR:/opt/printful-sync# echo "Done! Deploy timer with email notifications is ready."  Done! Deploy timer with email notifications is ready.                                       root@WOPR:/opt/printful-sync# systemctl start dude-deploy.service                           Job for dude-deploy.service failed because the control process exited with error code.      See "systemctl status dude-deploy.service" and "journalctl -xeu dude-deploy.service" for details.                                         root@WOPR:/opt/printful-sync# journalctl -u dude-deploy.service -f                          Dec 02 11:03:32 WOPR deploy.sh[868590]:  * branch              main       -> FETCH_HEAD     Dec 02 11:03:32 WOPR deploy.sh[868596]: error: Your local changes to the following files would be overwritten by merge:                   Dec 02 11:03:32 WOPR deploy.sh[868596]:         Dockerfile                                  Dec 02 11:03:32 WOPR deploy.sh[868596]: Please commit your changes or stash them before you merge.                                        Dec 02 11:03:32 WOPR deploy.sh[868596]: Aborting                                            Dec 02 11:03:32 WOPR deploy.sh[868596]: Updating e086f292..a7d01894                         Dec 02 11:03:32 WOPR systemd[1]: dude-deploy.service: Main process exited, code=exited, status=1/FAILURE                                  Dec 02 11:03:32 WOPR systemd[1]: dude-deploy.service: Failed with result 'exit-code'.       Dec 02 11:03:32 WOPR systemd[1]: Failed to start dude-deploy.service - The Dude Abides Store Deploy.                                      Dec 02 11:03:32 WOPR systemd[1]: dude-deploy.service: Triggering OnFailure= dependencies.                                                 ^C                                            root@WOPR:/opt/printful-sync#